<!-- Volver al árbol de cuentas -->
<div class="actions-bar">
  <a routerLink="/accounts/tree" class="btn btn-dark btn-sm">← Plan de Cuentas</a>
</div>

<form class="card" [formGroup]="accountForm" (ngSubmit)="onSubmit()">
  <div class="card-header">
    <h2>➕ Crear / Gestionar Cuenta</h2>
  </div>

  <div class="card-body grid-2">
    <div class="form-group">
      <label>Código *</label>
      <input type="text" formControlName="code" class="form-control" placeholder="Ej: 110" />
      <small class="text-danger" *ngIf="codeControl?.touched && codeControl?.invalid">
        Ingresá un código numérico.
      </small>
    </div>

    <div class="form-group">
      <label>Nombre *</label>
      <input type="text" formControlName="name" class="form-control" placeholder="Ej: Caja" />
      <small class="text-danger" *ngIf="nameControl?.touched && nameControl?.invalid">
        Mínimo 3 caracteres.
      </small>
    </div>

    <div class="form-group">
      <label>Tipo *</label>
      <select class="form-control" formControlName="type">
        <option *ngFor="let t of accountTypes" [value]="t.value">{{ t.label }}</option>
      </select>
    </div>

    <div class="form-group">
      <label>Naturaleza *</label>
      <select class="form-control" formControlName="balanceNature">
        <option *ngFor="let n of natureOptions" [value]="n.value">{{ n.label }}</option>
      </select>
      <small class="text-muted">Se ajusta automáticamente al cambiar el tipo.</small>
    </div>

    <div class="form-group">
      <label>Cuenta Padre</label>
      <select class="form-control" formControlName="parentCode">
        <option [ngValue]="null">— Sin padre —</option>
        <option *ngFor="let p of parentAccounts" [ngValue]="p.code">
          {{ p.code }} - {{ p.name }}
        </option>
      </select>
      <small class="text-muted">Solo se listan cuentas activas y no imputables.</small>
    </div>

    <div class="form-group">
      <label class="checkbox">
        <input type="checkbox" formControlName="imputable" />
        Es imputable
      </label>
    </div>
  </div>

  <div class="card-footer">
    <button class="btn btn-success" type="submit" [disabled]="loading || accountForm.invalid">💾 Guardar</button>
    <button class="btn btn-secondary" type="button" (click)="cancel()">✖ Cancelar</button>
  </div>

  <div *ngIf="message" class="alert alert-success mt-2">{{ message }}</div>
  <div *ngIf="error" class="alert alert-danger mt-2">{{ error }}</div>
</form>
