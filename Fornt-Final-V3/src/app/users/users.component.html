<div class="container mt-4">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h2 class="fw-semibold">User Management</h2>

    <button
      *ngIf="isAdmin()"
      class="btn btn-primary"
      (click)="goToCreateUser()">
      <i class="bi bi-person-plus"></i> New User
    </button>
  </div>

  <div *ngIf="loading" class="text-center py-5">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
  </div>

  <div *ngIf="!loading && users.length > 0">
    <table class="table table-hover align-middle shadow-sm">
      <thead class="table-dark">
      <tr>
        <th>#</th>
        <th>Username</th>
        <th>Email</th>
        <th>Role</th>
        <th>Status</th>
        <th class="text-center">Actions</th>
      </tr>
      </thead>
      <tbody>
      <tr *ngFor="let user of users; let i = index">
        <td>{{ i + 1 }}</td>
        <td>{{ user.username }}</td>
        <td>{{ user.email }}</td>
        <td>
            <span
              class="badge"
              [class.bg-primary]="user.role === 'ADMIN'"
              [class.bg-secondary]="user.role === 'USER'">
              {{ user.role }}
            </span>
        </td>
        <td>
            <span
              class="badge"
              [class.bg-success]="user.active"
              [class.bg-danger]="!user.active">
              {{ user.active ? 'Active' : 'Inactive' }}
            </span>
        </td>
        <td class="text-center">
          <button
            *ngIf="isAdmin()"
            class="btn btn-sm"
            [class.btn-outline-danger]="user.active"
            [class.btn-outline-success]="!user.active"
            (click)="toggleStatus(user)">
            <i class="bi" [ngClass]="user.active ? 'bi-person-x' : 'bi-person-check'"></i>
            {{ user.active ? 'Deactivate' : 'Activate' }}
          </button>
        </td>
      </tr>
      </tbody>
    </table>
  </div>

  <div *ngIf="!loading && users.length === 0" class="text-center text-muted mt-4">
    <p>No users found</p>
  </div>

  <p *ngIf="error" class="text-danger mt-3 text-center">{{ error }}</p>
</div>
